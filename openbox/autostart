#!/bin/sh

_vnc() {

    # daemons
    xsettingsd -c "${HOME}/arch/termite/xsettingsd" &

    # bacgkround
    xsetroot -solid '#008080'

    # interface
    tint2 -c "${HOME}/arch/tint2/tint2rc-vnc" &

    # keyboard (because raw inputs revert to US)
    # raw inputs are necessary for VirtualBox keyboard layout
    # requires rawkeyboard=1 in vnc config
    setxkbmap hr
}

_desktop() {

    # xorg settings
    #xinput set-prop 15 345 0.2
    xset -display :1 dpms 0 0 0
    nvidia-settings -a [gpu:0]/GpuPowerMizerMode=1
    
    # alsa
    "${HOME}/arch/scripts/sound.sh" pch

    # daemons
    xsettingsd -c "${HOME}/arch/termite/xsettingsd" &
    #xcompmgr -a &

    # resolution and background
    "${HOME}/arch/scripts/fixres.sh"
    #xwallpaper --stretch "${HOME}/arch/wall/default5.png"
    xwallpaper --output eDP-1-1 --stretch "${HOME}/arch/wall/exodus_v01_5120x2880.png" \
               --output HDMI-1-1 --stretch "${HOME}/arch/wall/exodus_v03_5120x2880.png" \
               --output DP-1-1 --stretch "${HOME}/arch/wall/exodus_v02_5120x2880.png"

    # conky kernel
    conky -q -d -c "${HOME}/arch/conky/conkyrc-kernel" --xinerama-head 0
    conky -q -d -c "${HOME}/arch/conky/conkyrc-kernel" --xinerama-head 1
    conky -q -d -c "${HOME}/arch/conky/conkyrc-kernel" --xinerama-head 2

    # conky tint2
    conky -q -d -c "${HOME}/arch/conky/conkyrc-tint2"

    # tray
    tint2 -c "${HOME}/arch/tint2/tint2rc-top" > /dev/null 2>&1 &
    tint2 -c "${HOME}/arch/tint2/tint2rc-bottom" > /dev/null 2>&1 &

    # other
    sleep 1
    "${HOME}/arch/scripts/clip.sh" > /dev/null 2>&1 &
}

if /usr/bin/xdpyinfo | grep VNC > /dev/null
then
    _vnc
else
    _desktop
fi
