xdpyinfo | grep VNC > /dev/null
declare isvnc=$? # 0 ako je vnc

log()
{
    mkdir -p $HOME/.local/logs
    ts "[%Y-%m-%dT%H:%M:%SZ][$1]" >> $HOME/.local/logs/openbox.log
}

vnc () {

    # log
    echo "Started VNC" | log VNC

    # daemons
    xsettingsd -c $HOME/arch/misc/xsettingsd &

    # bacgkround
    xsetroot -solid '#038387'

    # interface
    conky -c $HOME/arch/misc/conkyrc-headless -d
    # conky -c $HOME/arch/misc/conkyrc-sysinfo -d
    tint2 -c $HOME/arch/misc/tint2rc-top &
    tint2 -c $HOME/arch/misc/tint2rc-bottom &

}

desktop () {

    # log
    echo "Started Openbox" | log openbox

    # cpu
    sudo sh -c 'echo performance | tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor'
    
    # mouse sens
    xinput set-prop 11 326 0.5 |& log xinput
    
    # alsa
    alsactl restore -f $HOME/.config/asound.state |& log alsa

    # daemons
    xsettingsd -c $HOME/arch/misc/xsettingsd &
    xcompmgr -a &

    # resolution and background
    $HOME/arch/scripts/fixres.sh
    feh --bg-scale $HOME/arch/wall/default2.png
    #xsetroot -solid '#008080'

    # conky
    conky -c $HOME/arch/misc/conkyrc-headless |& log conky &

    conky -m 0 -c arch/misc/conky-kernel --xinerama-head 0 |& log conky &
    conky -m 0 -c arch/misc/conky-kernel --xinerama-head 1 |& log conky &
    conky -m 0 -c arch/misc/conky-kernel --xinerama-head 2 |& log conky &

    # tray
    tint2 -c $HOME/arch/misc/tint2rc-top    |& log tint2 &
    tint2 -c $HOME/arch/misc/tint2rc-bottom |& log tint2 &

    # other
    pnmixer                 |& log pnmixer &
    xfce4-clipman           |& log xfce4-clipman &
    (sleep 5 && flameshot)  |& log flameshot &
    (sleep 5 && synergy)    |& log synergy &

    # autolock
    #xautolock -time 60 -locker "systemctl suspend" -detectsleep &
    
}

[ $isvnc -eq 0 ] || desktop
[ $isvnc -eq 0 ] && vnc
